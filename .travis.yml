language: node_js
node_js:
  - 13.1.0
cache: bundler
sudo: required
services:
 - docker
#install heroku CLI for deployment
before_script:
 - curl https://toolbelt.heroku.com/install.sh | sudo sh
 - gem install bundler
script:
# fix rspec complaints
 - RAILS_ENV=test bundle exec rails assets:precompile
 - RAILS_ENV=test bundle exec rails db:migrate
 - bundle exec rspec spec/
# rubocop tends to think this is valid ruby code
 - sudo rm -r node_modules
 - bundle exec rubocop

after_success:
 - ./deployment.sh
